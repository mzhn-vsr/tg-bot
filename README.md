# ChatBot "Anton"

Интеллектуальный помощник сотрудника поддержки Rutube.
Поисковая система по базе знаний ЧаВо.

Основной стэк: `telegraf`, `fastify`, `nodejs`

## Требования

Бот использует взаимодействие с серверами Telegram через webhook, так что для работы потребуется публичный сервер с доменом.

## Функционал

- ЧаВо с пользователем на любой вопрос по теме Rutube
- Ограничение контекста разговора только базой знаний
- Ведение статистики запросов

## Развертывание

### Docker

Приложение поддерживает развертывание в среде Docker Compose

### Ручное развертывание

1. Установить необходимые библиотеки

   ```bash
   npm ci
   ```

2. Определить переменные среды (см. .env.example)
3. Запустить проект

   ```bash
   npm run start
   ```

Проект будет доступен по адресу `127.0.0.1:3000`

### Переменные среды

- `WEBHOOK_DOMAIN` - домен для webhook
- `WEBHOOK_PORT` - порт для webhook. Поддерживается 80, 88, 443, 8443
- `WEBHOOK_PATH` - секретный путь для работы webhook
- `WEBHOOK_SECRET` - Секретное значение для авторизации бота. Произвольная строка.
- `WEBHOOK_CERT` - (опиционально) Путь к файлу сертификата
- `LISTEN_PATH` - секретный путь для прослушивания webhook. Разница с WEBHOOK_PATH в том, что WEBHOOK_PATH отправляется в Telegram, а LISTEN_PATH прослушивается непосредственно сервером. Полезно для установки за reverse-proxy.
- `BOT_TOKEN` - токен бота
- `API_URL` - сервер ИИ
